<mat-toolbar class="menu">
  <button mat-icon-button [matMenuTriggerFor]="menu">
    <mat-icon class="menu-icon">menu</mat-icon>
  </button>

  <mat-menu #menu="matMenu">
    <a mat-menu-item href="/inicio">
      <mat-icon>house</mat-icon>
      <span>Início</span>
    </a>
    <a mat-menu-item href="/meus-agendamentos">
      <mat-icon>event_available</mat-icon>
      <span>Meus Agendamentos</span>
    </a>
    <button mat-menu-item>
      <mat-icon>badge</mat-icon>
      <span>Meus Dados</span>
    </button>
    @if (user.type === 'administrator') {
    <a mat-menu-item href="/admin">
      <mat-icon>admin_panel_settings</mat-icon>
      <span>Administrador</span>
    </a>
    }
    <a mat-menu-item href="https://www.verao.pr.gov.br/" target="_blank">
      <mat-icon>beach_access</mat-icon>
      <span>Verão Maior 2026</span>
    </a>
  </mat-menu>

  <span id="logo">
    <img src="images/verao-maior-menu.png" style="width: 220px" alt="Logo Verão Maior" />
  </span>

  <span class="example-spacer"></span>

  <button mat-icon-button [matMenuTriggerFor]="userMenu">
    <mat-icon class="menu-icon">account_circle</mat-icon>
  </button>

  <mat-menu #userMenu="matMenu">
    <button mat-menu-item disabled>
      <mat-icon class="material-icons-outlined">account_circle</mat-icon>
      <span>{{ user.name }}</span>
    </button>
    <button mat-menu-item (click)="logout()">
      <mat-icon>exit_to_app</mat-icon>
      <span>SAIR</span>
    </button>
  </mat-menu>
</mat-toolbar>

<mat-toolbar color="primary">
  <span>Meus Agendamentos</span>
</mat-toolbar>

<div class="container">
  <div class="actions-header">
    <button
      mat-stroked-button
      color="primary"
      class="load-schedules-button"
      (click)="loadSchedules()"
      [disabled]="isLoading()"
    >
      <mat-icon>refresh</mat-icon>
      Atualizar agendamentos
    </button>
  </div>

  <div class="schedule-grid">
    @for (resource of resources(); track resource._id) {
    <mat-card class="schedule-card">
      <mat-card-header>
        <div mat-card-avatar class="schedule-icon">
          <mat-icon>event</mat-icon>
        </div>
        <mat-card-title>{{ resource.resource }}</mat-card-title>
        <mat-card-subtitle>Protocolo: {{ resource._id.substring(0, 8) }}</mat-card-subtitle>
      </mat-card-header>

      <mat-card-content>
        <div class="info-row">
          <mat-nav-list>
            <a mat-list-item>
              <span matListItemTitle>{{ resource.date | date : 'dd/mm/yyyy' }}</span>
              <div matListItemMeta>
                <mat-icon>event-available</mat-icon>
              </div>
            </a>
          </mat-nav-list>
        </div>
        <div class="info-row">
          <mat-nav-list>
            <a mat-list-item>
              <span matListItemTitle>{{ resource.date | date : 'HH:mm' }}</span>
              <div matListItemMeta>
                <mat-icon>schedule</mat-icon>
              </div>
            </a>
          </mat-nav-list>
          <mat-nav-list>
            <a mat-list-item (click)="cancelSchedule(resource._id)" class="remove-schedule-button">
              <div matListItemMeta>
                <mat-icon class="remove-schedule-icon">delete</mat-icon>
              </div>
              <span matListItemTitle>Cancelar Agendamento</span>
            </a>
          </mat-nav-list>
        </div>
      </mat-card-content>
    </mat-card>
    } @empty {
    <mat-card class="alert-info">
      <mat-card-content class="alert-container">
        <div class="alert-message">
          <mat-icon color="primary">info</mat-icon>
          <p>Você não possui agendamentos ativos no momento.</p>
        </div>

        <a mat-flat-button color="primary" href="/agendar">
          <mat-icon>add_circle</mat-icon>
          AGENDAR AGORA
        </a>
      </mat-card-content>
    </mat-card>
    }
  </div>
</div>
